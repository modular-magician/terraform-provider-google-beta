---
# ----------------------------------------------------------------------------
#
#     ***     AUTO GENERATED CODE    ***    Type: MMv1     ***
#
# ----------------------------------------------------------------------------
#
#     This file is automatically generated by Magic Modules and manual
#     changes will be clobbered when the file is regenerated.
#
#     Please read more about how to change this file in
#     .github/CONTRIBUTING.md.
#
# ----------------------------------------------------------------------------
subcategory: "Data loss prevention"
description: |-
  A resource that combines all of the information about a DLP job.
---

# google\_data\_loss\_prevention\_job

A resource that combines all of the information about a DLP job.


To get more information about Job, see:

* [API documentation](https://cloud.google.com/dlp/docs/reference/rest/v2/projects.dlpJobs)
* How-to Guides
    * [Official Documentation](https://cloud.google.com/dlp/docs/creating-job-triggers)

## Example Usage - Dlp Risk Job With Job Id


```hcl
resource "google_data_loss_prevention_job" "basic" {
  parent = "projects/my-project-name"
  job_id = "tf_test"

  risk_job {
    actions {
      job_notification_emails {}
    }
    source_table {
      project_id = "my-project-name"
      dataset_id = google_bigquery_dataset.default.dataset_id
      table_id   = google_bigquery_table.default.table_id
    }
    privacy_metric {
      numerical_stats_config {
        field {
          name = "permalink"
        }
      }
    }
  }
}

resource "google_bigquery_dataset" "default" {
  dataset_id                  = "tf_test"
  friendly_name               = "terraform-test"
  description                 = "Description for the dataset created by terraform"
  location                    = "US"
  default_table_expiration_ms = 3600000

  labels = {
    env = "default"
  }
}

resource "google_bigquery_table" "default" {
  dataset_id          = google_bigquery_dataset.default.dataset_id
  table_id            = "tf_test"
  deletion_protection = false

  time_partitioning {
    type = "DAY"
  }

  labels = {
    env = "default"
  }

  schema = <<EOF
   [
    {
     "name": "permalink",
     "type": "NUMERIC",
     "mode": "NULLABLE",
     "description": "The Permalink"
    },
    {
     "name": "state",
     "type": "STRING",
     "mode": "NULLABLE",
     "description": "State where the head office is located"
    }
   ]
  EOF
}
```
## Example Usage - Dlp Risk Job Basic


```hcl
resource "google_data_loss_prevention_job" "basic" {
  parent = "projects/my-project-name"

  risk_job {
    actions {
      job_notification_emails {}
    }
    source_table {
      project_id = "my-project-name"
      dataset_id = google_bigquery_dataset.default.dataset_id
      table_id   = google_bigquery_table.default.table_id
    }
    privacy_metric {
      categorical_stats_config {
        field {
          name = "state"
        }
      }
    }
  }
}

resource "google_bigquery_dataset" "default" {
  dataset_id                  = "tf_test"
  friendly_name               = "terraform-test"
  description                 = "Description for the dataset created by terraform"
  location                    = "US"
  default_table_expiration_ms = 3600000

  labels = {
    env = "default"
  }
}

resource "google_bigquery_table" "default" {
  dataset_id          = google_bigquery_dataset.default.dataset_id
  table_id            = "tf_test"
  deletion_protection = false

  time_partitioning {
    type = "DAY"
  }

  labels = {
    env = "default"
  }

  schema = <<EOF
   [
    {
     "name": "permalink",
     "type": "NUMERIC",
     "mode": "NULLABLE",
     "description": "The Permalink"
    },
    {
     "name": "state",
     "type": "STRING",
     "mode": "NULLABLE",
     "description": "State where the head office is located"
    }
   ]
  EOF
}
```

## Argument Reference

The following arguments are supported:


* `parent` -
  (Required)
  The parent of the trigger, either in the format `projects/{{project}}` or `projects/{{project}}/locations/{{location}}`


- - -


* `job_id` -
  (Optional)
  The job id can contain uppercase and lowercase letters, numbers, and hyphens; that is,
  it must match the regular expression :- [a-zA-Z\d-_]+. The maximum length is 100 characters.
  Can be empty to allow the system to generate one.

* `risk_job` -
  (Optional)
  A risk analysis job calculates re-identification risk metrics for a BigQuery table.
  Structure is [documented below](#nested_risk_job).


<a name="nested_risk_job"></a>The `risk_job` block supports:

* `actions` -
  (Optional)
  A task to execute at the completion of the job.
  Structure is [documented below](#nested_actions).

* `privacy_metric` -
  (Required)
  Privacy metric to compute.
  Structure is [documented below](#nested_privacy_metric).

* `source_table` -
  (Required)
  Input dataset to compute metrics over.
  Structure is [documented below](#nested_source_table).


<a name="nested_actions"></a>The `actions` block supports:

* `save_findings` -
  (Optional)
  Save resulting findings in a provided location.
  Structure is [documented below](#nested_save_findings).

* `pub_sub` -
  (Optional)
  Publish a message into a given Pub/Sub topic when the job completes.
  Structure is [documented below](#nested_pub_sub).

* `job_notification_emails` -
  (Optional)
  Sends an email when the job completes. The email goes to IAM project owners and technical Essential Contacts.


<a name="nested_save_findings"></a>The `save_findings` block supports:

* `output_config` -
  (Required)
  Location to store findings outside of DLP.
  Structure is [documented below](#nested_output_config).


<a name="nested_output_config"></a>The `output_config` block supports:

* `table` -
  (Required)
  Information on the location of the target BigQuery Table.
  Structure is [documented below](#nested_table).


<a name="nested_table"></a>The `table` block supports:

* `project_id` -
  (Required)
  The Google Cloud Platform project ID of the project containing the table.

* `dataset_id` -
  (Required)
  Dataset ID of the table.

* `table_id` -
  (Optional)
  Name of the table. If it is not set, a new one will be generated for you with
  the following format :- `dlp_googleapis_yyyy_mm_dd_[dlp_job_id]`.
  Pacific timezone will be used for generating the date details.

<a name="nested_pub_sub"></a>The `pub_sub` block supports:

* `topic` -
  (Required)
  Cloud Pub/Sub topic to send notifications to. The topic must have given publishing access
  rights to the DLP API service account executing the long running DlpJob sending the
  notifications. Format is projects/{project}/topics/{topic}.

<a name="nested_privacy_metric"></a>The `privacy_metric` block supports:

* `numerical_stats_config` -
  (Optional)
  Compute numerical stats over an individual column, including min, max, and quantiles.
  Structure is [documented below](#nested_numerical_stats_config).

* `categorical_stats_config` -
  (Optional)
  Compute numerical stats over an individual column, including number of distinct values
  and value count distribution.
  Structure is [documented below](#nested_categorical_stats_config).

* `k_anonymity_config` -
  (Optional)
  k-anonymity metric, used for analysis of reidentification risk.
  Structure is [documented below](#nested_k_anonymity_config).

* `l_diversity_config` -
  (Optional)
  l-diversity metric, used for analysis of reidentification risk.
  Structure is [documented below](#nested_l_diversity_config).

* `k_map_estimation_config` -
  (Optional)
  Reidentifiability metric. This corresponds to a risk model similar to what is called "journalist risk"
  in the literature, except the attack dataset is statistically modeled instead of being perfectly known.
  This can be done using publicly available data (like the US Census), or using a custom statistical model
  (indicated as one or several BigQuery tables), or by extrapolating from the distribution of values
  in the input dataset.
  Structure is [documented below](#nested_k_map_estimation_config).

* `delta_presence_estimation_config` -
  (Optional)
  Î´-presence metric, used to estimate how likely it is for an attacker to figure
  out that one given individual appears in a de-identified dataset.
  Structure is [documented below](#nested_delta_presence_estimation_config).


<a name="nested_numerical_stats_config"></a>The `numerical_stats_config` block supports:

* `field` -
  (Required)
  Field to compute numerical stats on. Supported types are integer, float, date, datetime, timestamp, time.
  Structure is [documented below](#nested_field).


<a name="nested_field"></a>The `field` block supports:

* `name` -
  (Required)
  Name describing the field.

<a name="nested_categorical_stats_config"></a>The `categorical_stats_config` block supports:

* `field` -
  (Required)
  Field to compute categorical stats on. All column types are supported except for
  arrays and structs. However, it may be more informative to use NumericalStats when
  the field type is supported, depending on the data.
  Structure is [documented below](#nested_field).


<a name="nested_field"></a>The `field` block supports:

* `name` -
  (Required)
  Name describing the field.

<a name="nested_k_anonymity_config"></a>The `k_anonymity_config` block supports:

* `quasi_ids` -
  (Required)
  Set of fields to compute k-anonymity over. When multiple fields are specified,
  they are considered a single composite key. Structs and repeated data types are
  not supported; however, nested fields are supported so long as they are not
  structs themselves or nested within a repeated field.
  Structure is [documented below](#nested_quasi_ids).

* `entity_id` -
  (Optional)
  Message indicating that multiple rows might be associated to a single individual.
  If the same entityId is associated to multiple quasi-identifier tuples over distinct
  rows, we consider the entire collection of tuples as the composite quasi-identifier.
  This collection is a multiset :- the order in which the different tuples appear in
  the dataset is ignored, but their frequency is taken into account.
  Structure is [documented below](#nested_entity_id).


<a name="nested_quasi_ids"></a>The `quasi_ids` block supports:

* `name` -
  (Required)
  Name describing the field.

<a name="nested_entity_id"></a>The `entity_id` block supports:

* `field` -
  (Required)
  Composite key indicating which field contains the entity identifier.
  Structure is [documented below](#nested_field).


<a name="nested_field"></a>The `field` block supports:

* `name` -
  (Required)
  Name describing the field.

<a name="nested_l_diversity_config"></a>The `l_diversity_config` block supports:

* `quasi_ids` -
  (Required)
  Set of quasi-identifiers indicating how equivalence classes are defined for
  the l-diversity computation. When multiple fields are specified, they are
  considered a single composite key.
  Structure is [documented below](#nested_quasi_ids).

* `sensitive_attribute` -
  (Required)
  Sensitive field for computing the l-value.
  Structure is [documented below](#nested_sensitive_attribute).


<a name="nested_quasi_ids"></a>The `quasi_ids` block supports:

* `name` -
  (Required)
  Name describing the field.

<a name="nested_sensitive_attribute"></a>The `sensitive_attribute` block supports:

* `name` -
  (Required)
  Name describing the field.

<a name="nested_k_map_estimation_config"></a>The `k_map_estimation_config` block supports:

* `quasi_ids` -
  (Required)
  Fields considered to be quasi-identifiers. No two columns can have the same tag.
  Structure is [documented below](#nested_quasi_ids).

* `region_code` -
  (Optional)
  ISO 3166-1 alpha-2 region code to use in the statistical modeling. Set if no column
  is tagged with a region-specific InfoType (like US_ZIP_5) or a region code.

* `auxiliary_tables` -
  (Optional)
  Several auxiliary tables can be used in the analysis. Each customTag used to tag a
  quasi-identifiers column must appear in exactly one column of one auxiliary table.
  Structure is [documented below](#nested_auxiliary_tables).


<a name="nested_quasi_ids"></a>The `quasi_ids` block supports:

* `field` -
  (Required)
  Identifies the column.
  Structure is [documented below](#nested_field).

* `info_type` -
  (Optional)
  A column can be tagged with a InfoType to use the relevant public dataset as a statistical
  model of population, if available. We currently support US ZIP codes, region codes, ages
  and genders. To programmatically obtain the list of supported InfoTypes, use infoTypes.list
  with the supportedBy=RISK_ANALYSIS filter.
  Structure is [documented below](#nested_info_type).

* `custom_tag` -
  (Optional)
  A column can be tagged with a custom tag. In this case, the user must indicate an
  auxiliary table that contains statistical information on the possible values of
  this column (below).

* `inferred` -
  (Optional)
  If no semantic tag is indicated, we infer the statistical model from the distribution
  of values in the input data.


<a name="nested_field"></a>The `field` block supports:

* `name` -
  (Required)
  Name describing the field.

<a name="nested_info_type"></a>The `info_type` block supports:

* `name` -
  (Required)
  Name of the information type. Either a name of your choosing when creating a CustomInfoType,
  or one of the names listed at https://cloud.google.com/dlp/docs/infotypes-reference when
  specifying a built-in type. When sending Cloud DLP results to Data Catalog, infoType names
  should conform to the pattern [A-Za-z0-9$_-]{1,64}.

* `version` -
  (Optional)
  Version name for this InfoType.

<a name="nested_auxiliary_tables"></a>The `auxiliary_tables` block supports:

* `table` -
  (Required)
  Auxiliary table location.
  Structure is [documented below](#nested_table).

* `quasi_ids` -
  (Required)
  Quasi-identifier columns.
  Structure is [documented below](#nested_quasi_ids).

* `relative_frequency` -
  (Required)
  The relative frequency column must contain a floating-point number
  between 0 and 1 (inclusive). Null values are assumed to be zero.
  Structure is [documented below](#nested_relative_frequency).


<a name="nested_table"></a>The `table` block supports:

* `project_id` -
  (Required)
  The Google Cloud Platform project ID of the project containing the table.

* `dataset_id` -
  (Required)
  Dataset ID of the table.

* `table_id` -
  (Required)
  Name of the table.

<a name="nested_quasi_ids"></a>The `quasi_ids` block supports:

* `field` -
  (Required)
  Identifies the column.
  Structure is [documented below](#nested_field).

* `custom_tag` -
  (Required)
  A auxiliary field.


<a name="nested_field"></a>The `field` block supports:

* `name` -
  (Required)
  Name describing the field.

<a name="nested_relative_frequency"></a>The `relative_frequency` block supports:

* `name` -
  (Required)
  Name describing the field.

<a name="nested_delta_presence_estimation_config"></a>The `delta_presence_estimation_config` block supports:

* `quasi_ids` -
  (Required)
  Fields considered to be quasi-identifiers. No two fields can have the same tag.
  Structure is [documented below](#nested_quasi_ids).

* `region_code` -
  (Optional)
  ISO 3166-1 alpha-2 region code to use in the statistical modeling. Set if no column
  is tagged with a region-specific InfoType (like US_ZIP_5) or a region code.

* `auxiliary_tables` -
  (Optional)
  Several auxiliary tables can be used in the analysis. Each customTag used to tag a
  quasi-identifiers column must appear in exactly one column of one auxiliary table.
  Structure is [documented below](#nested_auxiliary_tables).


<a name="nested_quasi_ids"></a>The `quasi_ids` block supports:

* `field` -
  (Required)
  Identifies the column.
  Structure is [documented below](#nested_field).

* `info_type` -
  (Optional)
  A column can be tagged with a InfoType to use the relevant public dataset as a statistical
  model of population, if available. We currently support US ZIP codes, region codes, ages
  and genders. To programmatically obtain the list of supported InfoTypes, use infoTypes.list
  with the supportedBy=RISK_ANALYSIS filter.
  Structure is [documented below](#nested_info_type).

* `custom_tag` -
  (Optional)
  A column can be tagged with a custom tag. In this case, the user must indicate an
  auxiliary table that contains statistical information on the possible values of
  this column (below).

* `inferred` -
  (Optional)
  If no semantic tag is indicated, we infer the statistical model from the distribution
  of values in the input data.


<a name="nested_field"></a>The `field` block supports:

* `name` -
  (Required)
  Name describing the field.

<a name="nested_info_type"></a>The `info_type` block supports:

* `name` -
  (Required)
  Name of the information type. Either a name of your choosing when creating a CustomInfoType,
  or one of the names listed at https://cloud.google.com/dlp/docs/infotypes-reference when
  specifying a built-in type. When sending Cloud DLP results to Data Catalog, infoType names
  should conform to the pattern [A-Za-z0-9$_-]{1,64}.

* `version` -
  (Optional)
  Version name for this InfoType.

<a name="nested_auxiliary_tables"></a>The `auxiliary_tables` block supports:

* `table` -
  (Required)
  Auxiliary table location.
  Structure is [documented below](#nested_table).

* `quasi_ids` -
  (Required)
  Quasi-identifier columns.
  Structure is [documented below](#nested_quasi_ids).

* `relative_frequency` -
  (Required)
  The relative frequency column must contain a floating-point number
  between 0 and 1 (inclusive). Null values are assumed to be zero.
  Structure is [documented below](#nested_relative_frequency).


<a name="nested_table"></a>The `table` block supports:

* `project_id` -
  (Required)
  The Google Cloud Platform project ID of the project containing the table.

* `dataset_id` -
  (Required)
  Dataset ID of the table.

* `table_id` -
  (Required)
  Name of the table.

<a name="nested_quasi_ids"></a>The `quasi_ids` block supports:

* `field` -
  (Required)
  Identifies the column.
  Structure is [documented below](#nested_field).

* `custom_tag` -
  (Required)
  A column can be tagged with a custom tag. In this case, the user must indicate an
  auxiliary table that contains statistical information on the possible values of
  this column (below).


<a name="nested_field"></a>The `field` block supports:

* `name` -
  (Required)
  Name describing the field.

<a name="nested_relative_frequency"></a>The `relative_frequency` block supports:

* `name` -
  (Required)
  Name describing the field.

<a name="nested_source_table"></a>The `source_table` block supports:

* `project_id` -
  (Required)
  The Google Cloud Platform project ID of the project containing the table.

* `dataset_id` -
  (Required)
  Dataset ID of the table.

* `table_id` -
  (Required)
  Name of the table.

## Attributes Reference

In addition to the arguments listed above, the following computed attributes are exported:

* `id` - an identifier for the resource with format `{{parent}}/dlpJobs/{{name}}`

* `name` -
  The resource name of the job. Set by the server.

* `create_time` -
  Time when the job was created.

* `start_time` -
  Time when the job started.

* `end_time` -
  Time when the job finished.

* `type` -
  The type of job.

* `state` -
  State of a job.

* `job_trigger_name` -
  If created by a job trigger, the resource name of the trigger that instantiated the job.


## Timeouts

This resource provides the following
[Timeouts](https://developer.hashicorp.com/terraform/plugin/sdkv2/resources/retries-and-customizable-timeouts) configuration options:

- `create` - Default is 20 minutes.
- `delete` - Default is 20 minutes.

## Import


Job can be imported using any of these accepted formats:

```
$ terraform import google_data_loss_prevention_job.default {{parent}}/dlpJobs/{{name}}
$ terraform import google_data_loss_prevention_job.default {{parent}}/{{name}}
```
